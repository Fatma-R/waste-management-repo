<main class="employees-page">
  <div class="container">
    <div class="page-header">
      <div>
        <h1 class="page-title">Employee Management</h1>
        <p class="page-subtitle">Manage your waste collection team</p>
      </div>
      <div class="page-actions">
        <app-button variant="outline" (click)="goToDashboard()">
          ðŸ“Š Dashboard
        </app-button>
        <app-button variant="primary" (click)="openAddEmployeeModal()">
          + Add Employee
        </app-button>
      </div>
    </div>

    <div *ngIf="isLoading" class="loading-container">
      <app-loading-spinner message="Loading employees..."></app-loading-spinner>
    </div>

    <div *ngIf="!isLoading">
      <!-- Filters -->
      <div class="filter-bar">
        <div class="filter-group">
          <label for="filter-skill" class="filter-label">Skill:</label>
          <select
            id="filter-skill"
            [(ngModel)]="filterSkill"
            class="filter-select">
            <option value="all">All Skills</option>
            <option value="DRIVER">Driver</option>
            <option value="AGENT">Agent</option>
          </select>
        </div>

        <div class="filter-info">
          <span class="info-text">{{ filteredEmployees.length }} employees</span>
        </div>
      </div>

      <!-- Employees List -->
      <div class="employees-section">
        <h2 class="section-title">Team Members</h2>

        <div class="employees-grid">
          <app-card
            *ngFor="let employee of filteredEmployees"
            [hoverable]="true"
            padding="md"
            class="employee-card"
            (click)="selectEmployee(employee)">
            <div class="employee-header">
              <span class="employee-icon" aria-hidden="true">
                {{ getSkillIcon(employee.skill) }}
              </span>
              <div class="employee-info">
                <h3 class="employee-name">{{ employee.fullName }}</h3>
                <p class="employee-email">{{ employee.email }}</p>
              </div>
            </div>

            <div class="employee-details">
              <div class="detail-item">
                <span class="detail-label">Skill:</span>
                <span class="detail-value">{{ getSkillLabel(employee.skill) }}</span>
              </div>
              <div class="detail-item" *ngIf="employee.createdAt">
                <span class="detail-label">Created:</span>
                <span class="detail-value">{{ formatDate(employee.createdAt) }}</span>
              </div>
            </div>
          </app-card>

          <div *ngIf="filteredEmployees.length === 0" class="no-employees">
            <p>No employees match the selected filters</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Employee Details Modal -->
<app-modal
  [isOpen]="selectedEmployee !== null"
  [title]="selectedEmployee?.fullName || ''"
  size="md"
  (close)="deselectEmployee()">
  <div class="employee-details-modal" *ngIf="selectedEmployee">
    <div class="detail-section">
      <div class="detail-icon">{{ getSkillIcon(selectedEmployee.skill) }}</div>
      <h3 class="detail-heading">{{ selectedEmployee.fullName }}</h3>
    </div>

    <div class="detail-section">
      <div class="detail-row">
        <span class="detail-label">Email:</span>
        <span class="detail-value">{{ selectedEmployee.email }}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">Skill:</span>
        <span class="detail-value">{{ getSkillLabel(selectedEmployee.skill) }}</span>
      </div>
      <div class="detail-row" *ngIf="selectedEmployee.createdAt">
        <span class="detail-label">Created:</span>
        <span class="detail-value">{{ formatDate(selectedEmployee.createdAt) }}</span>
      </div>
      <div class="detail-row" *ngIf="selectedEmployee.updatedAt">
        <span class="detail-label">Updated:</span>
        <span class="detail-value">{{ formatDate(selectedEmployee.updatedAt) }}</span>
      </div>
    </div>

    <div class="modal-actions">
      <app-button
        variant="outline"
        size="sm"
        (click)="openEditEmployeeModal(selectedEmployee)">
        Edit Employee
      </app-button>
      <app-button
        variant="outline"
        size="sm"
        (click)="onDeleteEmployee(selectedEmployee.id)">
        Delete Employee
      </app-button>
    </div>
  </div>
</app-modal>

<!-- Create/Edit Employee Modal -->
<app-modal
  [isOpen]="isEmployeeFormModalOpen"
  [title]="formMode === 'create' ? 'Add New Employee' : 'Edit Employee'"
  size="md"
  (close)="closeEmployeeFormModal()">
  <form (ngSubmit)="onSubmitEmployeeForm()" class="add-employee-form">
    <div class="form-group">
      <label for="emp-name" class="form-label">Full Name</label>
      <input
        type="text"
        id="emp-name"
        [(ngModel)]="employeeForm.fullName"
        name="fullName"
        class="form-input"
        placeholder="John Smith"
        required>
    </div>

    <div class="form-group">
      <label for="emp-email" class="form-label">Email Address</label>
      <input
        type="email"
        id="emp-email"
        [(ngModel)]="employeeForm.email"
        name="email"
        class="form-input"
        placeholder="john@example.com"
        required>
    </div>

    <div class="form-group">
      <label for="emp-skill" class="form-label">Skill</label>
      <select
        id="emp-skill"
        [(ngModel)]="employeeForm.skill"
        name="skill"
        class="form-input"
        required>
        <option value="DRIVER">Driver</option>
        <option value="AGENT">Agent</option>
      </select>
    </div>

    <div class="modal-actions">
      <app-button
        type="button"
        variant="outline"
        (click)="closeEmployeeFormModal()">
        Cancel
      </app-button>
      <app-button type="submit" variant="primary">
        {{ formMode === 'create' ? 'Add Employee' : 'Save Changes' }}
      </app-button>
    </div>
  </form>
</app-modal>
