<main class="admin-page">
  <div class="container">
    <div class="page-header">
      <div>
        <h1 class="page-title">Admin Dashboard</h1>
        <p class="page-subtitle">System overview and administrative controls</p>
      </div>
      <div class="admin-badge">
        <span class="badge-icon" aria-hidden="true">ğŸ‘‘</span>
        <span class="badge-text">Administrator</span>
      </div>
    </div>

    <div *ngIf="isLoading" class="loading-container">
      <app-loading-spinner message="Loading admin data..."></app-loading-spinner>
    </div>

    <div *ngIf="!isLoading">
      <!-- System Stats -->
      <section class="kpi-section">
        <app-kpi
          label="Total Employees"
          [value]="totalEmployees"
          icon="ğŸ‘¥"
          color="sage">
        </app-kpi>
        
        <app-kpi
          label="Total Bins"
          [value]="totalBins"
          icon="ğŸ—‘ï¸"
          color="green">
        </app-kpi>
        
        <app-kpi
          label="Active Routes"
          [value]="activeRoutes"
          icon="ğŸš›"
          color="amber">
        </app-kpi>
        
        <app-kpi
          label="System Uptime"
          [value]="systemUptime"
          icon="âš¡"
          color="green">
        </app-kpi>
      </section>

      <!-- Main Content Grid -->
      <div class="admin-grid">
        <!-- Employee Management -->
        <app-card padding="lg" class="management-card">
          <div class="card-header">
            <h2 class="card-title">Employee Management</h2>
            <a routerLink="/employees" class="card-link">View All â†’</a>
          </div>

          <div class="management-list">
            <div 
              *ngFor="let employee of employees.slice(0, 5)"
              class="management-item">
              <div class="item-info">
                <span class="item-icon" aria-hidden="true">ğŸ‘¤</span>
                <div class="item-details">
                  <span class="item-name">{{ employee.name }}</span>
                  <span class="item-meta">{{ employee.role }} - {{ employee.email }}</span>
                </div>
              </div>
              <div class="item-actions">
                <span [class]="getStatusBadgeClass(employee.status)">
                  {{ employee.status }}
                </span>
                <button 
                  class="action-btn action-delete"
                  (click)="openDeleteEmployeeModal(employee.id)"
                  aria-label="Delete employee">
                  ğŸ—‘ï¸
                </button>
              </div>
            </div>
          </div>
        </app-card>

        <!-- Bin Management -->
        <app-card padding="lg" class="management-card">
          <div class="card-header">
            <h2 class="card-title">Bin Management</h2>
            <a routerLink="/map" class="card-link">View All â†’</a>
          </div>

          <div class="management-list">
            <div 
              *ngFor="let bin of bins.slice(0, 5)"
              class="management-item">
              <div class="item-info">
                <span class="item-icon" aria-hidden="true">ğŸ—‘ï¸</span>
                <div class="item-details">
                  <span class="item-name">Bin #{{ bin.id }} - {{ bin.type }}</span>
                  <span class="item-meta">{{ bin.zone }} - Fill: {{ bin.fillLevel }}%</span>
                </div>
              </div>
              <div class="item-actions">
                <span [class]="getStatusBadgeClass(bin.status)">
                  {{ bin.status }}
                </span>
                <button 
                  class="action-btn action-delete"
                  (click)="openDeleteBinModal(bin.id)"
                  aria-label="Delete bin">
                  ğŸ—‘ï¸
                </button>
              </div>
            </div>
          </div>
        </app-card>

        <!-- Activity Logs -->
        <app-card padding="lg" class="activity-card">
          <div class="card-header">
            <h2 class="card-title">Activity Logs</h2>
          </div>

          <div class="activity-list">
            <div 
              *ngFor="let log of activityLogs"
              class="activity-item">
              <span class="activity-icon" aria-hidden="true">
                {{ getActivityIcon(log.type) }}
              </span>
              <div class="activity-content">
                <div class="activity-header">
                  <span class="activity-user">{{ log.user }}</span>
                  <span class="activity-time">{{ formatTimestamp(log.timestamp) }}</span>
                </div>
                <p class="activity-action">{{ log.action }}</p>
                <p class="activity-details">{{ log.details }}</p>
              </div>
            </div>
          </div>
        </app-card>

        <!-- System Controls -->
        <app-card padding="lg" class="controls-card">
          <div class="card-header">
            <h2 class="card-title">System Controls</h2>
          </div>

          <div class="controls-grid">
            <button class="control-button">
              <span class="control-icon" aria-hidden="true">ğŸ“Š</span>
              <span class="control-label">Generate Reports</span>
            </button>
            
            <button class="control-button">
              <span class="control-icon" aria-hidden="true">ğŸ”„</span>
              <span class="control-label">Sync Database</span>
            </button>
            
            <button class="control-button">
              <span class="control-icon" aria-hidden="true">âš™ï¸</span>
              <span class="control-label">System Settings</span>
            </button>
            
            <button class="control-button">
              <span class="control-icon" aria-hidden="true">ğŸ“§</span>
              <span class="control-label">Email Notifications</span>
            </button>
            
            <button class="control-button">
              <span class="control-icon" aria-hidden="true">ğŸ”</span>
              <span class="control-label">Access Control</span>
            </button>
            
            <button class="control-button">
              <span class="control-icon" aria-hidden="true">ğŸ’¾</span>
              <span class="control-label">Backup System</span>
            </button>
          </div>
        </app-card>
      </div>
    </div>
  </div>
</main>

<!-- Delete Employee Confirmation Modal -->
<app-modal 
  [isOpen]="isDeleteEmployeeModalOpen"
  title="Delete Employee"
  size="sm"
  (close)="closeDeleteEmployeeModal()">
  <div class="confirm-modal">
    <p class="modal-description">
      Are you sure you want to delete this employee? This action cannot be undone.
    </p>
    <div class="modal-actions">
      <app-button 
        variant="outline" 
        (click)="closeDeleteEmployeeModal()">
        Cancel
      </app-button>
      <app-button 
        variant="primary"
        (click)="confirmDeleteEmployee()">
        Delete Employee
      </app-button>
    </div>
  </div>
</app-modal>

<!-- Delete Bin Confirmation Modal -->
<app-modal 
  [isOpen]="isDeleteBinModalOpen"
  title="Delete Bin"
  size="sm"
  (close)="closeDeleteBinModal()">
  <div class="confirm-modal">
    <p class="modal-description">
      Are you sure you want to delete this bin? This action cannot be undone.
    </p>
    <div class="modal-actions">
      <app-button 
        variant="outline" 
        (click)="closeDeleteBinModal()">
        Cancel
      </app-button>
      <app-button 
        variant="primary"
        (click)="confirmDeleteBin()">
        Delete Bin
      </app-button>
    </div>
  </div>
</app-modal>
